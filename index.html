<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Verano Surrealista – Publicación</title>
  <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400&family=Raleway&display=swap" rel="stylesheet">
  <style>
    * { margin:0; padding:0; box-sizing:border-box }
    body { background:#000; color:#fff; font-family:'Raleway',sans-serif; }
    .container { max-width:400px; margin:2rem auto; text-align:center; }
    h1 { font-family:'Oswald',sans-serif; text-transform:uppercase; margin-bottom:1rem; }
    input[type="file"] { display:block; margin:1rem auto; color:#fff; }
    canvas { display:block; margin:1rem auto; background:#222; }
    button {
      background:#222f3f; color:#fff; border:none;
      padding:.75rem 1.5rem; cursor:pointer; font-family:'Oswald',sans-serif;
      text-transform:uppercase; margin-top:1rem;
    }
    .instructions {
      font-family:'Oswald',sans-serif;
      text-transform:uppercase;
      color:#fff;
      margin:1rem 0;
      line-height:1.4;
    }
    .hidden { display:none; }
  </style>
</head>
<body>

  <!-- Página principal: carga y captura -->
  <div class="container" id="page-app">
    <h1>Publicación 3:4</h1>
    <input type="file" id="photoInput" accept="image/*">
    <canvas id="canvas" width="300" height="400"></canvas>
    <button id="downloadBtn" disabled>Descargar Foto</button>
  </div>

  <!-- Página final: instrucciones para redes -->
  <div class="container hidden" id="page-final">
    <h1>¡Listo!</h1>
    <p class="instructions">
      Sube tu foto a tus redes sociales, etiquétenos como <strong>@desafiodalimx</strong> y utiliza los hashtags:
    </p>
    <p class="instructions">
      #VeranoSurrealista  #EnigmaDalí  #DesafíoDalí
    </p>
  </div>

  <script>
    const photoInput  = document.getElementById('photoInput');
    const canvas      = document.getElementById('canvas');
    const ctx         = canvas.getContext('2d');
    const downloadBtn = document.getElementById('downloadBtn');
    const pageApp     = document.getElementById('page-app');
    const pageFinal   = document.getElementById('page-final');
    const frameImg    = new Image();
    frameImg.src      = 'assets/Marcopublicacion.png'; // tu PNG 300×400

    photoInput.onchange = () => {
      const file = photoInput.files[0];
      if (!file) return;
      const img = new Image();
      img.onload = () => {
        const cw = canvas.width, ch = canvas.height;
        const rPhoto = img.width / img.height;
        const rCanvas= cw / ch;
        let dw, dh, dx, dy;

        if (rPhoto > rCanvas) {
          dh = ch;
          dw = dh * rPhoto;
          dx = (cw - dw) / 2;
          dy = 0;
        } else {
          dw = cw;
          dh = dw / rPhoto;
          dx = 0;
          dy = (ch - dh) / 2;
        }

        ctx.clearRect(0,0,cw,ch);
        ctx.drawImage(img, dx, dy, dw, dh);
        ctx.drawImage(frameImg, 0, 0, cw, ch);
        downloadBtn.disabled = false;
      };
      img.src = URL.createObjectURL(file);
    };

    downloadBtn.onclick = () => {
      const link = document.createElement('a');
      link.download = 'foto-publicacion.png';
      link.href = canvas.toDataURL('image/png');
      link.click();
      // Mostrar la página final
      pageApp.classList.add('hidden');
      pageFinal.classList.remove('hidden');
    };
  </script>
</body>
</html>
